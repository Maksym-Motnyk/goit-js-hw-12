{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nlet currentPage = 1;\nlet currentQuery = '';\nlet totalHits = 0;\n\nfunction showLoader() {\n  const loader = document.querySelector('.loader');\n  loader.style.display = 'block';\n}\n\nfunction hideLoader() {\n  const loader = document.querySelector('.loader');\n  loader.style.display = 'none';\n}\n\nexport async function searchPhotos(query, page = 1) {\n  showLoader();\n\n  const searchParams = new URLSearchParams({\n    key: '43803497-a801e9cfe7ea9bdd19d306bb3',\n    q: query.trim(),\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: 15,\n    page: page,\n  });\n\n  const url = `https://pixabay.com/api/?${searchParams}`;\n\n  try {\n    const response = await axios.get(url);\n    totalHits = response.data.totalHits;\n    return response.data;\n  } catch (error) {\n    console.error('Error:', error);\n    throw error;\n  } finally {\n    hideLoader();\n  }\n}\n\nexport function resetPage() {\n  currentPage = 1;\n}\n\nexport function incrementPage() {\n  currentPage += 1;\n}\n\nexport function getCurrentPage() {\n  return currentPage;\n}\n\nexport function setCurrentQuery(query) {\n  currentQuery = query;\n}\n\nexport function getCurrentQuery() {\n  return currentQuery;\n}\n\nexport function getTotalHits() {\n  return totalHits;\n}\n","import simpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const listImg = document.querySelector('.list');\nlet lightbox;\n\nexport const markupInterface = data => {\n  const markup = data.hits\n    .map(hit => {\n      return `\n      <li class=\"item-list\">\n        <a href=\"${hit.largeImageURL}\" class=\"item-list-link\">\n            <img class=\"item-list-img\" src=\"${hit.webformatURL}\" alt=\"${hit.tags}\">\n        </a>\n        <div class='markup-info'>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"item-list-title\">Likes</h3>\n                <p class=\"item-list-text\">${hit.likes}</p>\n            </div>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"item-list-title\">Views</h3>\n                <p class=\"item-list-text\">${hit.views}</p>\n            </div>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"item-list-title\">Comments</h3>\n                <p class=\"item-list-text\">${hit.comments}</p>\n            </div>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"item-list-title\">Downloads</h3>\n                <p class=\"item-list-text\">${hit.downloads}</p>\n            </div>\n        </div>\n      </li>\n    `;\n    })\n    .join('');\n  listImg.innerHTML = markup;\n\n  lightbox = new SimpleLightbox('.item-list-link', {\n    captionsData: 'alt',\n    captionDelay: 250,\n    overlayOpacity: 0.8,\n  });\n\n  lightbox.refresh();\n};\n","import {\n  searchPhotos,\n  resetPage,\n  incrementPage,\n  getCurrentPage,\n  setCurrentQuery,\n  getCurrentQuery,\n  getTotalHits,\n} from './js/pixabay-api.js';\nimport { markupInterface, listImg } from './js/render-functions.js';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nconst searchButton = document.querySelector('.searchButton');\nconst loadMoreButton = document.querySelector('.btn');\n\nconst clearInput = () => {\n  const input = document.querySelector('.input');\n  input.value = '';\n};\n\nfunction hideLoader() {\n  const loader = document.querySelector('.loader');\n  loader.style.display = 'none';\n}\n\nsearchButton.addEventListener('click', async event => {\n  event.preventDefault();\n\n  const input = document.querySelector('.input');\n\n  if (input.value.trim() === '') {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'The search field cannot be empty! Please enter the search query!',\n    });\n    return;\n  }\n\n  resetPage();\n  setCurrentQuery(input.value);\n  listImg.innerHTML = '';\n  loadMoreButton.style.display = 'none';\n\n  try {\n    const data = await searchPhotos(getCurrentQuery(), getCurrentPage());\n    markupInterface(data);\n\n    if (data.hits.length) {\n      loadMoreButton.style.display = 'block';\n    }\n\n    if (data.totalHits === 0) {\n      iziToast.error({\n        title: 'Error',\n        message:\n          'Sorry, there was an error when receiving data. Please try again!',\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there was an error when receiving data. Please try again!',\n    });\n  }\n\n  clearInput();\n});\n\nloadMoreButton.addEventListener('click', async () => {\n  incrementPage();\n\n  try {\n    const data = await searchPhotos(getCurrentQuery(), getCurrentPage());\n    markupInterface(data);\n\n    const totalLoadedImages = document.querySelectorAll('.item-list').length;\n\n    if (totalLoadedImages >= getTotalHits()) {\n      loadMoreButton.style.display = 'none';\n      iziToast.error({\n        title: 'Error',\n        message: \"We're sorry, but you've reached the end of search results.\",\n      });\n    }\n\n    const { height: cardHeight } = document\n      .querySelector('.item-list')\n      .getBoundingClientRect();\n\n    window.scrollBy({\n      top: cardHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message:\n        'Sorry, there was an error when receiving data. Please try again!',\n    });\n  }\n});\n"],"names":["currentPage","currentQuery","totalHits","showLoader","loader","hideLoader","searchPhotos","query","page","url","response","axios","error","resetPage","incrementPage","getCurrentPage","setCurrentQuery","getCurrentQuery","getTotalHits","listImg","lightbox","markupInterface","data","markup","hit","searchButton","loadMoreButton","clearInput","input","event","iziToast","cardHeight"],"mappings":"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"}